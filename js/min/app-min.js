function setId(e){if(e!==currentId){spots.eachLayer(function(t){if(t.feature.properties.id===e){var o=t.feature.geometry.coordinates,r=$(".sprite");r.removeClass("active");var i=$("div[class*='"+e+"']")[0];i.className=i.className+" active",map.setView(o,16)}});for(var t=0;t<sections.length;t++)sections[t].className=sections[t].id===e?"active":"";return currentId=e,!0}}function fullscreenFix(){var e=$("body").height();$(".content-b").each(function(){$(this).innerHeight()<=e&&$(this).closest(".fullscreen").addClass("not-overflow")})}function fadeOnScroll(){var e=$("#splash");$(window).scroll(function(){e.fadeOut(1500)})}$(document).foundation(),L.mapbox.accessToken="pk.eyJ1IjoibGF1cmVuYmVuaWNob3UiLCJhIjoiQ1BlZGczRSJ9.EVMieITn7lHNi6Ato9wFwg";var map=L.mapbox.map("map","laurenbenichou.54e91cf8",{zoomControl:!1}).setView([37.812,-122.294],15);map.scrollWheelZoom.disable();var places={type:"FeatureCollection",features:[{geometry:{type:"Point",coordinates:[37.812,-122.294]},properties:{id:"cover",zoom:15},type:"Feature"},{geometry:{type:"Point",coordinates:[37.812515,-122.28703]},properties:{id:"defermery"},type:"Feature"},{geometry:{type:"Point",coordinates:[37.805054,-122.295128]},properties:{id:"bart"},type:"Feature"},{geometry:{type:"Point",coordinates:[37.815969,-122.316791]},properties:{id:"crane"},type:"Feature"},{geometry:{type:"Point",coordinates:[37.815694,-122.29724]},properties:{id:"station"},type:"Feature"},{geometry:{type:"Point",coordinates:[37.808917,-122.292539]},properties:{id:"mural"},type:"Feature"},{geometry:{type:"Point",coordinates:[37.826317,-122.278605]},properties:{id:"hotel"},type:"Feature"},{geometry:{type:"Point",coordinates:[37.818513,-122.278765]},properties:{id:"mcclymonds"},type:"Feature"}]},spots=L.mapbox.featureLayer().addTo(map);spots.setGeoJSON(places),spots.eachLayer(function(e){var t="sprite sprite-"+e.feature.properties.id,o=e.feature.geometry.coordinates,r=e.feature.properties.w,i=L.divIcon({className:t,iconSize:[80,80]});L.marker(o,{icon:i}).addTo(map)});var sections=$("section"),narrative=$("#narrative")[0],currentId="cover";narrative.onscroll=function(e){var t=narrative.offsetHeight,o=currentId;"cover"===o?$("body").attr("class","section-0"):$("body").attr("class"," ");for(var r=sections.length-1;r>=0;r--){var i=sections[r].getBoundingClientRect();i.top>=0&&i.top<=t&&(o=sections[r].id)}setId(o)},setId("cover"),$(window).resize(fullscreenFix),fullscreenFix(),fadeOnScroll();